<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 R Programming | Data Programming 數據編程學</title>
  <meta name="description" content="This book is prepared for training data scientists to do data programming or programming targeting data collection, production, curation, visualizatio and modeling. The first part will be focused on general programming grammar and principles. The following three sections will be on R, Python and JavaScript. Future developments may include other langauges (e.g. Ruby,Julia) or technologies (e.g. MapReduce, RHIPE). Samples programs will be provided. Version control information: R 3.6, RStudio 1.2.1114, Python 3.7, Anaconda 1.9.7" />
  <meta name="generator" content="bookdown 0.10 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 R Programming | Data Programming 數據編程學" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This book is prepared for training data scientists to do data programming or programming targeting data collection, production, curation, visualizatio and modeling. The first part will be focused on general programming grammar and principles. The following three sections will be on R, Python and JavaScript. Future developments may include other langauges (e.g. Ruby,Julia) or technologies (e.g. MapReduce, RHIPE). Samples programs will be provided. Version control information: R 3.6, RStudio 1.2.1114, Python 3.7, Anaconda 1.9.7" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 R Programming | Data Programming 數據編程學" />
  
  <meta name="twitter:description" content="This book is prepared for training data scientists to do data programming or programming targeting data collection, production, curation, visualizatio and modeling. The first part will be focused on general programming grammar and principles. The following three sections will be on R, Python and JavaScript. Future developments may include other langauges (e.g. Ruby,Julia) or technologies (e.g. MapReduce, RHIPE). Samples programs will be provided. Version control information: R 3.6, RStudio 1.2.1114, Python 3.7, Anaconda 1.9.7" />
  

<meta name="author" content="Karl Ho 何嘉耀 (洪碩庭 翻譯）" />


<meta name="date" content="2019-05-29" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="intro.html">
<link rel="next" href="python-programming.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Data Programming</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Prerequisites課前準備</a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> 簡介</a><ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#section"><i class="fa fa-check"></i><b>2.1</b> 程式設計原則</a></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#section-1"><i class="fa fa-check"></i><b>2.2</b> 資料程式的功能</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="r-programming.html"><a href="r-programming.html"><i class="fa fa-check"></i><b>3</b> R Programming</a><ul>
<li class="chapter" data-level="3.1" data-path="r-programming.html"><a href="r-programming.html#what-is-r"><i class="fa fa-check"></i><b>3.1</b> What is R?</a><ul>
<li class="chapter" data-level="3.1.1" data-path="r-programming.html"><a href="r-programming.html#some-history-of-r-and-s"><i class="fa fa-check"></i><b>3.1.1</b> Some history of R and S</a></li>
<li class="chapter" data-level="3.1.2" data-path="r-programming.html"><a href="r-programming.html#it-is"><i class="fa fa-check"></i><b>3.1.2</b> It is:</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="r-programming.html"><a href="r-programming.html#why-r"><i class="fa fa-check"></i><b>3.2</b> Why R?</a></li>
<li class="chapter" data-level="3.3" data-path="r-programming.html"><a href="r-programming.html#rstudio"><i class="fa fa-check"></i><b>3.3</b> RStudio</a></li>
<li class="chapter" data-level="3.4" data-path="r-programming.html"><a href="r-programming.html#basic-operations-and-object-assignment"><i class="fa fa-check"></i><b>3.4</b> Basic operations and object assignment</a></li>
<li class="chapter" data-level="3.5" data-path="r-programming.html"><a href="r-programming.html#illustration"><i class="fa fa-check"></i><b>3.5</b> Illustration</a></li>
<li class="chapter" data-level="3.6" data-path="r-programming.html"><a href="r-programming.html#exercise"><i class="fa fa-check"></i><b>3.6</b> Exercise</a></li>
<li class="chapter" data-level="3.7" data-path="r-programming.html"><a href="r-programming.html#recommended-r-resources"><i class="fa fa-check"></i><b>3.7</b> Recommended R Resources:</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="python-programming.html"><a href="python-programming.html"><i class="fa fa-check"></i><b>4</b> Python Programming</a><ul>
<li class="chapter" data-level="4.1" data-path="python-programming.html"><a href="python-programming.html#what-is-python"><i class="fa fa-check"></i><b>4.1</b> What is Python?</a><ul>
<li class="chapter" data-level="4.1.1" data-path="python-programming.html"><a href="python-programming.html#why-python"><i class="fa fa-check"></i><b>4.1.1</b> Why Python?</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="python-programming.html"><a href="python-programming.html#python-basic-packges"><i class="fa fa-check"></i><b>4.2</b> Python basic packges:</a></li>
<li class="chapter" data-level="4.3" data-path="python-programming.html"><a href="python-programming.html#python-ide"><i class="fa fa-check"></i><b>4.3</b> Python IDE</a></li>
<li class="chapter" data-level="4.4" data-path="python-programming.html"><a href="python-programming.html#basic-operations-and-object-assignment-1"><i class="fa fa-check"></i><b>4.4</b> Basic operations and object assignment</a><ul>
<li class="chapter" data-level="4.4.1" data-path="python-programming.html"><a href="python-programming.html#import-libraries"><i class="fa fa-check"></i><b>4.4.1</b> Import libraries</a></li>
<li class="chapter" data-level="4.4.2" data-path="python-programming.html"><a href="python-programming.html#import-data"><i class="fa fa-check"></i><b>4.4.2</b> Import data</a></li>
<li class="chapter" data-level="4.4.3" data-path="python-programming.html"><a href="python-programming.html#simple-plot"><i class="fa fa-check"></i><b>4.4.3</b> Simple plot</a></li>
<li class="chapter" data-level="4.4.4" data-path="python-programming.html"><a href="python-programming.html#visualizing-data"><i class="fa fa-check"></i><b>4.4.4</b> Visualizing data</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="python-programming.html"><a href="python-programming.html#exercise-1"><i class="fa fa-check"></i><b>4.5</b> Exercise</a></li>
<li class="chapter" data-level="4.6" data-path="python-programming.html"><a href="python-programming.html#recommended-python-resources"><i class="fa fa-check"></i><b>4.6</b> Recommended Python Resources:</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="javascript.html"><a href="javascript.html"><i class="fa fa-check"></i><b>5</b> JavaScript</a><ul>
<li class="chapter" data-level="5.1" data-path="javascript.html"><a href="javascript.html#what-is-javascript"><i class="fa fa-check"></i><b>5.1</b> What is JavaScript?</a><ul>
<li class="chapter" data-level="5.1.1" data-path="javascript.html"><a href="javascript.html#javascript-data-types"><i class="fa fa-check"></i><b>5.1.1</b> JavaScript Data Types</a></li>
<li class="chapter" data-level="5.1.2" data-path="javascript.html"><a href="javascript.html#json"><i class="fa fa-check"></i><b>5.1.2</b> JSON</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="javascript.html"><a href="javascript.html#what-is-d3"><i class="fa fa-check"></i><b>5.2</b> What is D3?</a><ul>
<li class="chapter" data-level="5.2.1" data-path="javascript.html"><a href="javascript.html#d3-and-web-documents"><i class="fa fa-check"></i><b>5.2.1</b> D3 and web documents</a></li>
<li class="chapter" data-level="5.2.2" data-path="javascript.html"><a href="javascript.html#sample-d3-graphics"><i class="fa fa-check"></i><b>5.2.2</b> Sample D3 graphics</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="summary.html"><a href="summary.html"><i class="fa fa-check"></i><b>6</b> Summary</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Programming 數據編程學</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="r-programming" class="section level1">
<h1><span class="header-section-number">Chapter 3</span> R Programming</h1>
<div id="what-is-r" class="section level2">
<h2><span class="header-section-number">3.1</span> What is R?</h2>
<p>The R statistical programming language is a free, open source package based on the S language developed by John Chambers.</p>
<div id="some-history-of-r-and-s" class="section level3">
<h3><span class="header-section-number">3.1.1</span> Some history of R and S</h3>
<p>S was further developed into R by Robert Gentlemen (Canada) and Ross Ihaka (New Zealand)</p>
<div class="figure"><span id="fig:Rinventors"></span>
<img src="Rinventors.png" alt="R Inventors" width="100%" />
<p class="caption">
Figure 3.1: R Inventors
</p>
</div>
<p>Source: <a href="https://rss.onlinelibrary.wiley.com/doi/10.1111/j.1740-9713.2018.01169.x">Nick Thieme. 2018. R Generation: 25 years of R</a></p>
</div>
<div id="it-is" class="section level3">
<h3><span class="header-section-number">3.1.2</span> It is:</h3>
<ul>
<li>Large, probably one of the largest based on the user-written add-ons/procedures</li>
<li>Object-oriented</li>
<li>Interactive</li>
<li>Multiplatform: Windows, Mac, Linux</li>
</ul>
<p>According to John Chambers (2009), six facets of R:</p>
<ol style="list-style-type: decimal">
<li>an interface to computational procedures of many kinds;</li>
<li>interactive, hands-on in real time;</li>
<li>functional in its model of programming;</li>
<li>object-oriented, “everything is an object”;</li>
<li>modular, built from standardized pieces; and,</li>
<li>collaborative, a world-wide, open-source effort.</li>
</ol>
<div class="figure"><span id="fig:Rdevelopers"></span>
<img src="Rdevelopers.png" alt="Prominent R Developers" width="100%" />
<p class="caption">
Figure 3.2: Prominent R Developers
</p>
</div>
<p>Source: <a href="https://rss.onlinelibrary.wiley.com/doi/10.1111/j.1740-9713.2018.01169.x">Nick Thieme. 2018. R Generation: 25 years of R</a></p>
</div>
</div>
<div id="why-r" class="section level2">
<h2><span class="header-section-number">3.2</span> Why R?</h2>
<ul>
<li>A programming platform environment</li>
<li>Allow development of software/packages by users</li>
<li>Currently, the CRAN package repository features over 14,000 available packages (as of May, 2019).</li>
<li>Graphics!!!</li>
<li>Scaleble and Portable</li>
<li>Interface with other platform/langauges (e.g. C++, Python, JavaScript, Stan, SQL)</li>
<li>Comparing R with other software?</li>
</ul>
<div class="figure"><span id="fig:Rcompare"></span>
<img src="Rcompare.png" alt="R Compared with other statistical programs/platforms" width="100%" />
<p class="caption">
Figure 3.3: R Compared with other statistical programs/platforms
</p>
</div>
<p>Source: Oscar Torres-Reyna. 2010. <a href="https://dss.princeton.edu/training/RStata.pdf">Getting Started in R~Stata Notes on Exploring Data</a></p>
</div>
<div id="rstudio" class="section level2">
<h2><span class="header-section-number">3.3</span> RStudio</h2>
<p>RStudio is a user interface for the statistical programming software R.</p>
<ul>
<li>Object-based environment</li>
<li>Window system</li>
<li>Point and click operations</li>
<li>Coding recommended<br />
</li>
<li>Expansions and development</li>
<li>a multi-functional Integrated Development Environment (IDE)</li>
</ul>
<div class="figure"><span id="fig:Rstudioscreenshot"></span>
<img src="RStudioscreenshot.png" alt="RStudio screenshot" width="100%" />
<p class="caption">
Figure 3.4: RStudio screenshot
</p>
</div>
</div>
<div id="basic-operations-and-object-assignment" class="section level2">
<h2><span class="header-section-number">3.4</span> Basic operations and object assignment</h2>
<p>Arithmetic Operations:</p>
<p>+, -, *, /, ^ are the standard arithmetic operators.</p>
<p>Assignment</p>
<p>To assign a value to a variable use “&lt;-” or “=”:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">## Introduction to R sample program </span>
<span class="co">## file: introR02.R</span>
<span class="co">## Adapted from Venables, W.N., Smith, D.M. and Team, R.C., 2018. An Introduction to R, Version 3.5.1 (2018-07-02)</span>


<span class="co"># Clear any existing objects </span>
<span class="kw">rm</span>(<span class="dt">list =</span> <span class="kw">ls</span>())

<span class="co"># Generate x, y and w to demontrate linear models and plots.</span>
<span class="co"># Make x = (1,2,...,20).</span>

x &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">20</span>

<span class="co"># Create A ‘weight’ vector of standard deviations.</span>

w &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="kw">sqrt</span>(x)<span class="op">/</span><span class="dv">2</span>

<span class="co"># Create a data frame of two columns, x and y.</span>

dummy &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x=</span>x, <span class="dt">y=</span> x <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(x)<span class="op">*</span>w)

<span class="co"># Fit a simple linear regression </span>
<span class="co"># With y to the left of the tilde then x, meaning y being dependent on x.</span>
<span class="co"># Unlike other statistical packages, R does not display all output.  It is recommended</span>
<span class="co"># to create an object to store the estimates.</span>

fm &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x, <span class="dt">data=</span>dummy) 

<span class="co"># Display the summary of the output of model fm.</span>

<span class="kw">summary</span>(fm)</code></pre>
<pre><code>## 
## Call:
## lm(formula = y ~ x, data = dummy)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -6.6189 -1.8705 -0.2017  1.6484  6.5759 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   1.2201     1.4320   0.852    0.405    
## x             0.9381     0.1195   7.848 3.22e-07 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 3.083 on 18 degrees of freedom
## Multiple R-squared:  0.7738, Adjusted R-squared:  0.7613 
## F-statistic: 61.59 on 1 and 18 DF,  p-value: 3.217e-07</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Use w for a weighted regression.</span>

fm1 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x, <span class="dt">data=</span>dummy, <span class="dt">weight=</span><span class="dv">1</span><span class="op">/</span>w<span class="op">^</span><span class="dv">2</span>) 

<span class="co"># Display the summary of the output of model fm1.</span>

<span class="kw">summary</span>(fm1)</code></pre>
<pre><code>## 
## Call:
## lm(formula = y ~ x, data = dummy, weights = 1/w^2)
## 
## Weighted Residuals:
##     Min      1Q  Median      3Q     Max 
## -2.1155 -0.6401 -0.1246  0.6805  2.2497 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   1.4551     1.0327   1.409    0.176    
## x             0.9160     0.1053   8.698 7.29e-08 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.141 on 18 degrees of freedom
## Multiple R-squared:  0.8078, Adjusted R-squared:  0.7971 
## F-statistic: 75.66 on 1 and 18 DF,  p-value: 7.295e-08</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Make the columns in the data frame visible as variables.</span>

<span class="kw">attach</span>(dummy)

<span class="co"># Make a nonparametric local regression function. </span>

lrf &lt;-<span class="st"> </span><span class="kw">lowess</span>(x, y)

<span class="co"># Standard point plot, with plotting character (pch) as bullet.</span>

<span class="kw">plot</span>(x, y,<span class="dt">pch=</span><span class="dv">20</span>) 

<span class="co"># Add in the local regression.</span>

<span class="kw">lines</span>(x, lrf<span class="op">$</span>y)

<span class="co"># The true regression line: (intercept 0, slope 1, with dotted line type )</span>

<span class="kw">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dt">lty=</span><span class="dv">3</span>)

<span class="co"># Unweighted regression line.</span>

<span class="kw">abline</span>(<span class="kw">coef</span>(fm))

<span class="co"># Weighted regression line.</span>

<span class="kw">abline</span>(<span class="kw">coef</span>(fm1), <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</code></pre>
<p><img src="DataProgramming_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># A standard regression diagnostic plot to check for heteroscedasticity. Can you see it?</span>

<span class="kw">plot</span>(<span class="kw">fitted</span>(fm), <span class="dt">pch=</span><span class="dv">20</span>, <span class="kw">resid</span>(fm), <span class="dt">xlab=</span><span class="st">&quot;Fitted values&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;Residuals&quot;</span>, <span class="dt">main=</span><span class="st">&quot;Residuals vs Fitted&quot;</span>)

<span class="co"># How about now?</span>

<span class="kw">abline</span>(<span class="dv">0</span>,<span class="dv">0</span>, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>)  </code></pre>
<p><img src="DataProgramming_files/figure-html/unnamed-chunk-6-2.png" width="672" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># A normal scores plot to check for skewness, kurtosis and outliers.</span>

<span class="kw">qqnorm</span>(<span class="kw">resid</span>(fm), <span class="dt">main=</span><span class="st">&quot;Residuals Rankit Plot&quot;</span>, <span class="dt">pch=</span><span class="dv">17</span>)</code></pre>
<p><img src="DataProgramming_files/figure-html/unnamed-chunk-6-3.png" width="672" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Cleaning up</span>

<span class="kw">rm</span>(<span class="dt">list =</span> <span class="kw">ls</span>())</code></pre>
</div>
<div id="illustration" class="section level2">
<h2><span class="header-section-number">3.5</span> Illustration</h2>
<p>In this section, we demonstrate exploring data about Taiwan elections in 2016. The Taiwan Election and Democratization Study (TEDS) is one of the longest and most comprehensive elections studies starting in 2001. TEDS collects data through different modes of surveys including face-to-face interviews, telephone interviews and internet surveys. More detail of TEDS can be found at the National Chengchi University Election Study Center website at <a href="https://esc.nccu.edu.tw/main.php">https://esc.nccu.edu.tw/main.php</a>.</p>
<p><em>Taiwan Election and Democratization Study 2016 data</em></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Import the TEDS 2016 data in Stata format using the haven package</span>
<span class="co">## install.packages(&quot;haven&quot;)</span>

<span class="kw">library</span>(haven)
TEDS_<span class="dv">2016</span> &lt;-<span class="st"> </span><span class="kw">read_stata</span>(<span class="st">&quot;https://github.com/datageneration/home/blob/master/DataProgramming/data/TEDS_2016.dta?raw=true&quot;</span>)

<span class="co"># Prepare the analyze the Party ID variable </span>
<span class="co"># Assign label to the values (1=KMT, 2=DPP, 3=NP, 4=PFP, 5=TSU, 6=NPP, 7=&quot;NA&quot;)</span>

TEDS_<span class="dv">2016</span><span class="op">$</span>PartyID &lt;-<span class="st"> </span><span class="kw">factor</span>(TEDS_<span class="dv">2016</span><span class="op">$</span>PartyID, <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;KMT&quot;</span>,<span class="st">&quot;DPP&quot;</span>,<span class="st">&quot;NP&quot;</span>,<span class="st">&quot;PFP&quot;</span>, <span class="st">&quot;TSU&quot;</span>, <span class="st">&quot;NPP&quot;</span>,<span class="st">&quot;NA&quot;</span>))</code></pre>
<p>Take a look at the variable:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Check the variable</span>
<span class="kw">attach</span>(TEDS_<span class="dv">2016</span>)
<span class="kw">head</span>(PartyID)</code></pre>
<pre><code>## [1] NA  NA  KMT NA  NA  DPP
## Levels: KMT DPP NP PFP TSU NPP NA</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">tail</span>(PartyID)</code></pre>
<pre><code>## [1] NA  NA  DPP NA  NA  NA 
## Levels: KMT DPP NP PFP TSU NPP NA</code></pre>
<p>Frequency table:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Run a frequency table of the Party ID variable using the descr package</span>
<span class="co">## install.packages(&quot;descr&quot;)</span>
<span class="kw">library</span>(descr)
<span class="kw">freq</span>(TEDS_<span class="dv">2016</span><span class="op">$</span>PartyID)</code></pre>
<p><img src="DataProgramming_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<pre><code>## TEDS_2016$PartyID 
##       Frequency  Percent
## KMT         388  22.9586
## DPP         591  34.9704
## NP            3   0.1775
## PFP          32   1.8935
## TSU           5   0.2959
## NPP          43   2.5444
## NA          628  37.1598
## Total      1690 100.0000</code></pre>
<p>Get a better chart of the Party ID variable:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Plot the Party ID variable</span>
<span class="kw">ggplot</span>(TEDS_<span class="dv">2016</span>, <span class="kw">aes</span>(PartyID)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_bar</span>()</code></pre>
<p><img src="DataProgramming_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p>We can attend to more detail of the chart, such as adding labels to x and y axes, and calculating the percentage instead of counts.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(TEDS_<span class="dv">2016</span>, <span class="kw">aes</span>(PartyID)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">y =</span> (..count..)<span class="op">/</span><span class="kw">sum</span>(..count..))) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">labels=</span>scales<span class="op">::</span>percent) <span class="op">+</span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Party Support (%)&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Taiwan Political Parties&quot;</span>)</code></pre>
<p><img src="DataProgramming_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<p>Adding colors, with another theme:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(TEDS_<span class="dv">2016</span>, <span class="kw">aes</span>(PartyID)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">y =</span> (..count..)<span class="op">/</span><span class="kw">sum</span>(..count..),<span class="dt">fill=</span>PartyID)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">labels=</span>scales<span class="op">::</span>percent) <span class="op">+</span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Party Support (%)&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Taiwan Political Parties&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_bw</span>()</code></pre>
<p><img src="DataProgramming_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p>Hold on, colors are not right!</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(TEDS_<span class="dv">2016</span>, <span class="kw">aes</span>(PartyID)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">y =</span> (..count..)<span class="op">/</span><span class="kw">sum</span>(..count..),<span class="dt">fill=</span>PartyID)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">labels=</span>scales<span class="op">::</span>percent) <span class="op">+</span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Party Support (%)&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Taiwan Political Parties&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values=</span><span class="kw">c</span>(<span class="st">&quot;steel blue&quot;</span>,<span class="st">&quot;forestgreen&quot;</span>,<span class="st">&quot;khaki1&quot;</span>,<span class="st">&quot;orange&quot;</span>,<span class="st">&quot;goldenrod&quot;</span>,<span class="st">&quot;yellow&quot;</span>,<span class="st">&quot;grey&quot;</span>))</code></pre>
<p><img src="DataProgramming_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<p>To make the chart more meaningful, we can use a package called tidyverse to manage the data.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">##install.packages(&quot;tidyverse&quot;)</span>
<span class="kw">library</span>(tidyverse)
TEDS_<span class="dv">2016</span> <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">count</span>(PartyID) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">perc =</span> n <span class="op">/</span><span class="st"> </span><span class="kw">nrow</span>(TEDS_<span class="dv">2016</span>)) -&gt;<span class="st"> </span>T2
<span class="kw">ggplot</span>(T2, <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">reorder</span>(PartyID, <span class="op">-</span>perc),<span class="dt">y =</span> perc,<span class="dt">fill=</span>PartyID)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Party Support (%)&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Taiwan Political Parties&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values=</span><span class="kw">c</span>(<span class="st">&quot;steel blue&quot;</span>,<span class="st">&quot;forestgreen&quot;</span>,<span class="st">&quot;khaki1&quot;</span>,<span class="st">&quot;orange&quot;</span>,<span class="st">&quot;goldenrod&quot;</span>,<span class="st">&quot;yellow&quot;</span>,<span class="st">&quot;grey&quot;</span>))</code></pre>
<p><img src="DataProgramming_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
<div id="exercise" class="section level2">
<h2><span class="header-section-number">3.6</span> Exercise</h2>
<p>Analyze the Tondu (統獨）variable using the following procedures:</p>
<ol style="list-style-type: decimal">
<li>Assign label to each category</li>
<li>Run a frequency table using descr</li>
<li>Plot the variable using ggplot2</li>
</ol>
<p>Hint:</p>
<ul>
<li>Prepare the analyze the Tondu variable using these labesl: (“Unification now”,“Status quo, unif. in future”,“Status quo, decide later”,“Status quo forever”, “Status quo, indep. in future”, “Independence now”,“No response”)</li>
<li>Sample codes:</li>
</ul>
<pre><code>TEDS_2016$Tondu&lt;-factor(TEDS_2016$Tondu,labels=c(&quot;Unification now&quot;,&quot;Status quo, unif. in &gt;future&quot;,&quot;Status quo, decide later&quot;,&quot;Status quo forever&quot;, &gt;&quot;Status quo, indep. in future&quot;, &quot;Independence now&quot;,&quot;No &gt;response&quot;))</code></pre>
</div>
<div id="recommended-r-resources" class="section level2">
<h2><span class="header-section-number">3.7</span> Recommended R Resources:</h2>
<ul>
<li><a href="http://journal.r-project.org/">The R Journal</a></li>
<li><a href="http://cran.r-project.org/doc/manuals/R-intro.pdf">Introduction to R by W. N. Venables, D. M. Smith and the R Core Team</a></li>
<li><a href="http://www.ats.ucla.edu/stat/r/seminars/intro.htm">Introduction to R Seminar at UCLA</a></li>
<li><a href="https://dss.princeton.edu/training/">Getting Started in Data Analysis using Stata and R by Data and Statistical Services, Princeton University</a></li>
</ul>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="intro.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="python-programming.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/02-RProgramming.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": ["DataProgramming.pdf", "DataProgramming.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
